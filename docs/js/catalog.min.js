(()=>{"use strict";var t;!function(t){t.goods="goods",t.sp="sp",t.tff="tff",t.contacts="contacts"}(t||(t={}));const e="https://jsonplaceholder.typicode.com",s={shops:{goods:`${e}/goods`,test:`${e}/todos/1`}};class i{constructor(){this.selector=".popup",this.popupCloseSelector=".popup__close",this.dataAttributePopup="[data-popup]",this.dataAttributeClosePopup="[data-close-popup]",this.popupOpenClass="popup--open",this.overflowClass="overflow",this.popupOverlayClass="popup__overlay",this.init()}init(){this.handlers(),[768,1200].forEach((t=>{window.matchMedia(`(min-width:${t}px)`).addListener((t=>this.breakpointChecker(t)))}))}breakpointChecker(t){const e=t.media.replace(/\D/g,"");Array.from(document.querySelectorAll(`${this.selector}--open`)).forEach((t=>{const s=t.dataset.media;Number(e)>=Number(s)&&this.closePopup(t)}))}openPopup(t){const e=document.getElementById(t.dataset.popup||"");if(!e)throw new Error(`no attribute value: ${this.dataAttributePopup}`);{let t=!0;const s=Number(e.dataset.media);s&&s<window.innerWidth&&(t=!1),t&&(e.classList.add(this.popupOpenClass),document.body.classList.add(this.overflowClass),document.dispatchEvent(new CustomEvent("openPopup",{detail:null==e?void 0:e.id})))}}checkOpenedPopups(){return[...document.querySelectorAll(this.selector)].some((t=>t.classList.contains("popup--open")))}closePopup(t){var e;const s=t.closest(this.selector)||document.getElementById((null===(e=null==t?void 0:t.dataset)||void 0===e?void 0:e.closePopup)||"");null==s||s.classList.remove(this.popupOpenClass),this.checkOpenedPopups()||document.body.classList.remove(this.overflowClass),document.dispatchEvent(new CustomEvent("closePopup",{detail:null==s?void 0:s.id}))}clickHandler(t){const e=t.target;return e.closest(this.dataAttributeClosePopup)&&e.closest(this.dataAttributePopup)?(this.closePopup(e),this.openPopup(e.closest(this.dataAttributePopup))):e.classList.contains(this.popupOverlayClass)||e.closest(this.popupCloseSelector)||e.closest(this.dataAttributeClosePopup)?this.closePopup(e):void(e.closest(this.dataAttributePopup)&&this.openPopup(e.closest(this.dataAttributePopup)))}handlers(){document.addEventListener("click",(t=>this.clickHandler(t)))}}class o{constructor(){this.selectorActionBtn=".header__nav-more",this.selectorUsefulLinks=".useful-links",this.selectorUsefulLinksCross=".useful-links__title-cross";const t=document.querySelector(this.selectorUsefulLinks);t&&(this.usefulLinksElem=t),this.usefulLinksElem&&this.init()}init(){window.matchMedia("(min-width:1200px)").addListener((t=>this.breakpointChecker(t))),this.handlers()}breakpointChecker(t){this.usefulLinksElem.classList.contains("active")&&(t.matches?document.body.classList.remove("overflow"):document.body.classList.add("overflow"))}toggle(){this.usefulLinksElem.classList.toggle("active"),document.body.classList.toggle("overflow")}clickHandler(t){const e=t.target;(e.closest(this.selectorActionBtn)||e.closest(this.selectorUsefulLinksCross))&&this.toggle()}handlers(){document.addEventListener("click",(t=>this.clickHandler(t)))}}const n=(t,e)=>{return s=void 0,i=void 0,n=function*(){const s=Object.assign(Object.assign({},{method:"get",credentials:"include"}),e);try{const e=yield fetch(t,Object.assign({credentials:s.credentials,headers:"get"===s.method?{}:{"Content-Type":"application/json"}},s)),{status:i}=e,o=yield e.json();return o.detail?{error:o.detail,status:i}:{data:o,status:i}}catch(t){return{error:t}}},new((o=void 0)||(o=Promise))((function(t,e){function l(t){try{a(n.next(t))}catch(t){e(t)}}function c(t){try{a(n.throw(t))}catch(t){e(t)}}function a(e){var s;e.done?t(e.value):(s=e.value,s instanceof o?s:new o((function(t){t(s)}))).then(l,c)}a((n=n.apply(s,i||[])).next())}));var s,i,o,n};class l{constructor(t,e,s){this.selectorForm=t,this.url=e,this.apiOptions=s;const i=document.querySelector(this.selectorForm);i&&(this.form=i),this.form&&this.init()}init(){this.handlers()}getData(){const t=new FormData(this.form);return Array.from(t.entries()).reduce(((t,[e,s])=>(t[e]=s,t)),{})}submitForm(){return t=this,e=void 0,i=function*(){const t=this.getData(),{method:e}=this.apiOptions;let s=this.url;if("get"===e){const e=new URLSearchParams;Object.entries(t).forEach((([t,s])=>e.append(t,String(s)))),s=`${this.url}?${e.toString()}`}else this.apiOptions=Object.assign(Object.assign({},this.apiOptions),{body:JSON.stringify(t)});return yield n(s,this.apiOptions)},new((s=void 0)||(s=Promise))((function(o,n){function l(t){try{a(i.next(t))}catch(t){n(t)}}function c(t){try{a(i.throw(t))}catch(t){n(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(l,c)}a((i=i.apply(t,e||[])).next())}));var t,e,s,i}validateForm(){}resetForm(){}handlers(){this.form.addEventListener("submit",(t=>{t.preventDefault(),this.submitForm()}))}}class c{constructor(){this.selectorContainer=".login",this.selectorBtnSignIn=".login__choice-sign-in",this.selectorBtnSignUp=".login__choice-sign-up";const t=document.querySelector(this.selectorContainer);t&&(this.containerElem=t);const e=document.querySelector(this.selectorBtnSignIn);e&&(this.btnSignInElem=e);const s=document.querySelector(this.selectorBtnSignUp);s&&(this.btnSignUpElem=s),this.btnSignInElem&&this.btnSignUpElem?this.init():console.error(`No items found: ${this.selectorBtnSignIn}, ${this.selectorBtnSignUp}`)}init(){this.handlers()}toggle(t){t.closest(this.selectorBtnSignIn)?(this.containerElem.classList.remove(`${this.selectorContainer.substring(1)}--sign-up`),this.containerElem.classList.add(`${this.selectorContainer.substring(1)}--sign-in`)):(this.containerElem.classList.remove(`${this.selectorContainer.substring(1)}--sign-in`),this.containerElem.classList.add(`${this.selectorContainer.substring(1)}--sign-up`))}clickHandler(t){const e=t.target;(e.closest(this.selectorBtnSignIn)||e.closest(this.selectorBtnSignUp))&&this.toggle(e)}handlers(){document.addEventListener("click",(t=>this.clickHandler(t)))}}class a{constructor(){this.mapId="#maps",this.searchPickupId="#search-pickup",this.courierAddressId="#courier",this.isLoadMap=!1,this.deliveryType="pickup",this.headerSelector=".header",this.mapSelector=".map",this.searchInputSelector=".map__address-actions-input input",this.mapYandexSelector=".map__yandex",this.addressSelector=".location__address",this.addressSelectedSelector=`${this.addressSelector}--selected`,this.addressRemoveSelector=`${this.addressSelector}-remove`,this.radioDeliveryName="choose-delivery",this.addressElems=Array.from(document.querySelectorAll(this.addressSelector));const t=document.querySelector(this.mapId);t&&(this.iframeMapElem=t);const e=document.querySelector(this.searchPickupId);e&&(this.searchPickupElem=e);const s=document.querySelector(this.courierAddressId);s&&(this.courierAddressElem=s);const i=document.querySelector(this.mapSelector);i&&(this.mapElem=i);const o=document.querySelector(this.mapYandexSelector);o&&(this.mapYandexElem=o);const n=document.querySelector(this.searchInputSelector);n&&(this.searchInputElem=n);const l=document.querySelector(this.headerSelector);l&&(this.headerElem=l),this.init()}init(){this.handlers(),this.mapElem.classList.add(`${this.mapSelector.substring(1)}--pickup`),window.matchMedia("(min-width:1200px)").addListener((t=>this.breakpointChecker(t))),navigator.geolocation.getCurrentPosition((function(t){console.log(t.coords.latitude,t.coords.longitude)}),(function(t){console.log(t.message)}))}breakpointChecker(t){t.matches&&(this.searchPickupElem.classList.remove("popup--open"),this.courierAddressElem.classList.remove("popup--open"))}selectedAddress(t){this.addressElems.forEach((e=>{e.classList.remove(this.addressSelectedSelector.substring(1)),e===t&&e.classList.add(this.addressSelectedSelector.substring(1))}))}removeAddress(t){return e=this,s=void 0,o=function*(){const e=t.dataset.value;console.log("remove address",e)},new((i=void 0)||(i=Promise))((function(t,n){function l(t){try{a(o.next(t))}catch(t){n(t)}}function c(t){try{a(o.throw(t))}catch(t){n(t)}}function a(e){var s;e.done?t(e.value):(s=e.value,s instanceof i?s:new i((function(t){t(s)}))).then(l,c)}a((o=o.apply(e,s||[])).next())}));var e,s,i,o}openPopupSearch(){this.searchPickupElem.classList.add("popup--open")}openPopupCourier(){this.courierAddressElem.classList.add("popup--open")}selectedOption(t){console.log("options",t)}changeDelivery(t){"courier"===t?(this.mapElem.classList.remove(`${this.mapSelector.substring(1)}--pickup`),this.mapElem.classList.add(`${this.mapSelector.substring(1)}--courier`)):(this.mapElem.classList.remove(`${this.mapSelector.substring(1)}--courier`),this.mapElem.classList.add(`${this.mapSelector.substring(1)}--pickup`)),this.deliveryType=t}clickHandler(t){const e=t.target,s=e.closest(this.addressSelector),i=e.closest(this.addressRemoveSelector);if(!this.isLoadMap&&e.closest('[data-popup="map"]')){const t=this.iframeMapElem.dataset.src;this.iframeMapElem.addEventListener("load",(()=>{this.mapYandexElem.classList.add(`${this.mapYandexSelector.substring(1)}--load`)})),t&&(this.iframeMapElem.src=t,this.isLoadMap=!0)}if(i&&s)return this.removeAddress(s);s&&!i&&this.selectedAddress(s)}focusHandler(t){t.target===this.searchInputElem&&window.innerWidth<1200&&("pickup"===this.deliveryType&&this.openPopupSearch(),"courier"===this.deliveryType&&this.openPopupCourier())}changeHandler(t){const e=t.target,s=e.name,i=e.value;s===this.radioDeliveryName&&this.changeDelivery(i)}handlers(){this.headerElem.addEventListener("click",(t=>this.clickHandler(t))),this.headerElem.addEventListener("focusin",(t=>this.focusHandler(t))),this.headerElem.addEventListener("change",(t=>this.changeHandler(t)))}}class r{constructor({id:t,url:e,callback:s}){this.id=t,this.url=e,this.callback=s,this.isOpen=!1,this.containerSelector=".autocomplete",this.inputWrapperSelector=`${this.containerSelector}__input`,this.optionsSelector=`${this.containerSelector}__options`,this.itemSelector=`${this.containerSelector}__options-item`;const i=document.querySelector(`#${this.id}`);i&&(this.containerElem=i);const o=this.containerElem.querySelector(this.inputWrapperSelector);o&&(this.inputWrapperElem=o);const n=this.inputWrapperElem.querySelector("input");n&&(this.inputElem=n);const l=this.containerElem.querySelector("input[hidden]");l&&(this.hiddenInputElem=l);const c=this.containerElem.querySelector(this.optionsSelector);c&&(this.optionsElem=c),this.init()}init(){this.handlers(),this.collectedInitialOptions()}renderOptions(){this.optionsElem.innerHTML="";const t=this.searchOptions.map((({label:t,value:e})=>`<li class="autocomplete__options-item" data-value="${e}" tabindex="0">${t}</li>`)).join("");this.optionsElem.innerHTML=t}collectedInitialOptions(){const t=Array.from(this.containerElem.querySelectorAll(this.itemSelector)).reduce(((t,e)=>{const s=e.innerHTML,i=e.dataset.value;return s&&i?[...t,{label:s,value:i}]:t}),[]);this.options=t}toggle(){this.isOpen=!this.isOpen,this.containerElem.classList.toggle("active")}selected(t){const e=t.dataset.value,s=t.innerHTML;s&&(this.inputElem.value=s),e&&(this.hiddenInputElem.value=e),this.callback&&s&&e&&this.callback({label:s,value:e})}searchMatch(t){return e=this,s=void 0,o=function*(){if(this.url&&t){this.containerElem.classList.add("load");const t=yield n(this.url,{});return this.containerElem.classList.remove("load"),t.error?void console.error("Error fetching data:",t.error):void(Array.isArray(t.data)?(this.searchOptions=t.data,this.renderOptions()):console.error("Unexpected response format:",t))}const e=new RegExp(t,"i"),s=this.options.filter((t=>e.test(t.label)));this.searchOptions=s,this.renderOptions()},new((i=void 0)||(i=Promise))((function(t,n){function l(t){try{a(o.next(t))}catch(t){n(t)}}function c(t){try{a(o.throw(t))}catch(t){n(t)}}function a(e){var s;e.done?t(e.value):(s=e.value,s instanceof i?s:new i((function(t){t(s)}))).then(l,c)}a((o=o.apply(e,s||[])).next())}));var e,s,i,o}clickHandler(t){const e=t.target;(this.inputWrapperElem.contains(e)||!this.containerElem.contains(e)&&this.isOpen)&&this.toggle(),this.containerElem.contains(e)&&e.closest(this.itemSelector)&&this.selected(e)}inputHandler(t){const e=t.target;this.containerElem.contains(e)&&(this.searchMatch(e.value),this.isOpen||this.toggle())}handlers(){document.addEventListener("click",(t=>this.clickHandler(t))),document.addEventListener("input",(t=>this.inputHandler(t)))}}window.addEventListener("load",(()=>{let t;!function(t){let e=new Image;e.onload=e.onerror=function(){!function(t){let e=!0===t?"webp":"no-webp";document.documentElement.classList.add(e)}(2==e.height)},e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}();try{new i}catch(t){console.log(t)}try{new o}catch(t){console.log(t)}try{new l(".login__form-sign-in",s.shops.test,{method:"post"})}catch(t){console.log(t)}try{new l(".login__form-sign-up",s.shops.test,{method:"post"})}catch(t){console.log(t)}try{new c}catch(t){console.log(t)}try{t=new a}catch(t){console.log(t)}try{new r({id:"search-pickup-autocomplete",url:"../files/stubs/autocomplete.json",callback:null==t?void 0:t.selectedOption})}catch(t){console.log(t)}}));class h{constructor(){this.init()}init(){this.handlers()}changeTab(t){const e=t.dataset.tabPath,s=t.closest(".tabs__list"),i=null==s?void 0:s.querySelectorAll(".tabs__tab"),o=document.querySelector(`[data-tab-target="${e}"]`),n=null==o?void 0:o.closest(".tabs__contents"),l=null==n?void 0:n.querySelectorAll(".tabs__content");null==i||i.forEach((t=>t.classList.remove("tabs__tab--active"))),t.classList.add("tabs__tab--active"),null==l||l.forEach((t=>t.classList.remove("tabs__content--active"))),null==o||o.classList.add("tabs__content--active")}clickHandler(t){const e=t.target.closest(".tabs__tab");e&&this.changeTab(e)}handlers(){document.addEventListener("click",(t=>this.clickHandler(t)))}}class d{constructor(){this.selector=".collapse",this.init()}init(){this.handlers()}toggleCollapse(t){const e=t.closest(this.selector);e&&(e.classList.contains("collapse--close")?(e.classList.remove("collapse--close"),e.classList.add("collapse--open")):(null==e?void 0:e.classList.contains("collapse--open"))?(e.classList.remove("collapse--open"),e.classList.add("collapse--close")):e.classList.add("collapse--close"))}clickHandler(t){const e=t.target;if(e.closest(".collapse__head")&&"INPUT"!==e.tagName)return this.toggleCollapse(e)}handlers(){document.addEventListener("click",(t=>this.clickHandler(t)))}}class u{constructor(){this.selectorSelect=".select",this.selectorHeader=".select__header",this.selectorTitle=".select__title",this.selectorOptions=".select__options",this.selectorItem=".select__options-item",this.selectorIcon=".select__icon",this.allSelects=Array.from(document.querySelectorAll(".select")),0!==this.allSelects.length&&this.init()}init(){this.initialOption(),this.handlers()}initialOption(){this.allSelects.forEach((t=>{var e;const s=null===(e=t.querySelector("input"))||void 0===e?void 0:e.value,i=t.querySelector(this.selectorTitle);if(null==i?void 0:i.textContent)return;let o,n;if(s){const e=t.querySelector(`[data-value=${s}]`);o=null==e?void 0:e.innerHTML,n=e}else{const e=t.querySelector(this.selectorItem);o=null==e?void 0:e.innerHTML,n=e}i&&o&&(i.innerHTML=o),null==n||n.classList.add("active")}))}toggle(t){const e=t.querySelector(this.selectorIcon);null==e||e.classList.toggle("active"),t.classList.toggle("active")}changeOption(t,e){var s;const i=t.querySelector(this.selectorTitle),o=t.querySelector("input"),n=e.dataset.value,l=e.innerHTML;i&&o&&n&&(i.innerHTML=l,o.value=n,this.toggle(t)),t.querySelectorAll(this.selectorItem).forEach((t=>t.classList.remove("active"))),null===(s=null==e?void 0:e.closest(this.selectorItem))||void 0===s||s.classList.add("active")}clickHandler(t){const e=t.target,s=null==e?void 0:e.closest(this.selectorSelect);this.allSelects.forEach((t=>{if(s!==t){t.classList.remove("active");const e=t.querySelector(this.selectorIcon);null==e||e.classList.remove("active")}})),s&&((null==e?void 0:e.closest(this.selectorHeader))&&this.toggle(s),(null==e?void 0:e.closest(this.selectorOptions))&&this.changeOption(s,e))}handlers(){document.addEventListener("click",(t=>this.clickHandler(t)))}}class p{constructor({selectorContainer:t,breakpointsSettings:e,tagName:s}){this.selectorContainer=t,this.breakpointsSettings=e,this.tagName=s||"div";const i=[...document.querySelectorAll(this.selectorContainer)];i.length>0&&(this.containersElem=i),0!==this.containersElem.length&&Object.keys(e).length&&this.init()}init(){Object.keys(this.breakpointsSettings).forEach((t=>{window.matchMedia(`(min-width:${t}px)`).addListener((()=>this.build()))})),this.masonryAll=new Map,this.containersElem.forEach((t=>{this.masonryAll.set(t,[...t.children].map((t=>t.cloneNode(!0))))})),this.build()}getColumnsCount(){const t=window.innerWidth,e=Object.keys(this.breakpointsSettings).map((t=>Number(t))).filter((e=>e<=t));return this.breakpointsSettings[(null==e?void 0:e.at(-1))||e[0]||Object.keys(this.breakpointsSettings)[0]]}build(){const t=this.getColumnsCount();this.masonryAll.forEach(((e,s)=>{s.innerHTML="";for(let e=0;e<t;e++){const t=document.createElement(this.tagName);t.className="masonry-column",s.appendChild(t)}const i=s.children,o=i.length-1;let n=0;e.forEach((t=>{i[n].appendChild(t),n===o?n=0:n+=1}))}))}}class m{constructor(){this.selectorMobile=".catalog__mobile",this.selectorDesktop=".catalog__desktop",this.catalogSelected="";const t=document.querySelector(this.selectorMobile);t&&(this.containerMobile=t);const e=document.querySelector(this.selectorDesktop);e&&(this.containerDesktop=e),this.containerMobile&&this.containerDesktop&&this.init()}init(){this.catalogsMobile=[...document.querySelectorAll(`${this.selectorMobile} [data-catalog]`)],this.catalogsDesktop=new Map,[...document.querySelectorAll(`${this.selectorDesktop} .catalog__menu-item`)].forEach((t=>{const e=t.dataset.tabPath,s=document.querySelector(`.catalog__content [data-tab-target="${e}"]`);this.catalogsDesktop.set(t,s)})),this.handlers()}syncFromMobile(t){this.catalogsDesktop.forEach(((e,s)=>{s.classList.remove("tabs__tab--active"),e.classList.remove("tabs__content--active"),s.dataset.tabPath===t&&(s.classList.add("tabs__tab--active"),e.classList.add("tabs__content--active"))}))}syncFromDesktop(t){const e=this.catalogsMobile.find((e=>e.dataset.catalog===t));if(e){const t=e.querySelector(".collapse");t.classList.remove("collapse--close"),t.classList.add("collapse--open"),this.mobileCatalogSelected&&this.closeCurrentCollapse(this.mobileCatalogSelected),this.mobileCatalogSelected=e}}closeCurrentCollapse(t){const e=t.querySelector(".collapse");e.classList.remove("collapse--open"),e.classList.add("collapse--close")}searchCatalogMobile(t){const e=t.closest(".catalog__item");if(e){const t=e.dataset.catalog;if(t){if(this.catalogSelected===t)return;this.mobileCatalogSelected&&this.closeCurrentCollapse(this.mobileCatalogSelected),this.mobileCatalogSelected=e,this.catalogSelected=t,this.syncFromMobile(t)}}}searchCatalogDesktop(t){const e=t.closest(".tabs__tab");if(e){const t=e.dataset.tabPath;if(t){if(this.catalogSelected===t)return;this.catalogSelected=t,this.syncFromDesktop(t)}}}syncCatalog(t){this.checkDesktopWidth()?this.searchCatalogDesktop(t):this.searchCatalogMobile(t)}checkDesktopWidth(){return window.innerWidth>=1200}clickHandler(t){const e=t.target;this.syncCatalog(e)}handlers(){document.addEventListener("click",(t=>this.clickHandler(t)))}}class g{constructor(){this.selectorBtn=".btn-show",this.selectorBtnText=".btn-show-text",this.selectorHideElem=".hide-elem",this.selectorShowElem=".show-elem",this.init()}init(){this.handlers()}toggleElem(t){[...t.querySelectorAll(this.selectorHideElem)].forEach((t=>{t.classList.contains(this.selectorShowElem.substring(1))?t.classList.remove(this.selectorShowElem.substring(1)):t.classList.add(this.selectorShowElem.substring(1))}))}action(t){t.classList.toggle("active");const e=t.parentElement;if(e){const s=t.querySelector(this.selectorBtnText),i=null==s?void 0:s.textContent,o=t.dataset.text;i&&o&&s&&(s.textContent=o,t.dataset.text=i),this.toggleElem(e)}}clickHandler(t){const e=t.target.closest(this.selectorBtn);e&&this.action(e)}handlers(){document.addEventListener("click",(t=>this.clickHandler(t)))}}window.addEventListener("load",(()=>{try{new p({selectorContainer:".catalog__mobile .catalog__list",breakpointsSettings:{375:1,768:2}})}catch(t){console.log(t)}try{new p({selectorContainer:".catalog__desktop .catalog__masonry",breakpointsSettings:{1200:3,1920:4}})}catch(t){console.log(t)}try{new h}catch(t){console.log(t)}try{new u}catch(t){console.log(t)}try{new d}catch(t){console.log(t)}try{new m}catch(t){console.log(t)}try{new g}catch(t){console.log(t)}}))})();